title: Cookie 和 LocalStorage 的安全风险及防护措施
date: 2025-04-24 10:58:13
category: 知识备忘
tags: browser

---

### **Cookie 的安全风险**

1. **跨站脚本攻击 (XSS)**：攻击者通过注入恶意脚本窃取存储在 Cookie 中的敏感信息。
2. **跨站请求伪造 (CSRF)**：恶意网站可以利用用户的登录状态（通过未保护的 Cookie）发送未经授权的请求。
3. **中间人攻击 (MITM)**：如果没有使用 HTTPS，攻击者可以在网络传输过程中截获 Cookie 数据。
4. **不正确的配置**：如 `HttpOnly` 标志未设置，允许 JavaScript 访问包含敏感数据的 Cookie；或 `Secure` 标志未启用，在非 HTTPS 连接上传输 Cookie。

##### **防护措施**

- **使用 HttpOnly 和 Secure 标志**：确保 Cookie 不能通过客户端脚本访问 (`HttpOnly`) 并且只通过 HTTPS 传输 (`Secure`)。
- **SameSite 属性**：防止 CSRF 攻击，限制 Cookie 是否应与跨站请求一起发送。
- **加密敏感数据**：对存储在 Cookie 中的敏感信息进行加密处理。
- **定期更新和清理**：及时删除不再需要的 Cookie，并定期轮换 Cookie 值。

### **LocalStorage 的安全风险**

1. **XSS 攻击**：与 Cookie 类似，如果网站存在 XSS 漏洞，攻击者可以通过执行恶意脚本来读取或修改 LocalStorage 中的数据。
2. **缺乏域隔离**：LocalStorage 在同源策略下共享，这意味着同一域名下的所有页面都可以访问相同的数据，增加了数据泄露的风险。
3. **持久性存储**：数据永久保存直到被手动清除，这可能使得旧数据成为潜在的安全隐患。

##### **防护措施**

- **最小化敏感数据存储**：避免在 LocalStorage 中存储敏感信息如密码、令牌等。
- **加密存储**：对于必须存储在 LocalStorage 中的重要数据，采用强加密算法加密后再存储。
- **输入验证和输出编码**：防止 XSS 攻击，确保所有用户输入都经过严格验证并正确编码输出。
- **定期清理过期数据**：主动管理 LocalStorage 内容，移除不再需要的数据以减少暴露面。

### 总结

无论是 Cookie 还是 LocalStorage，都需要采取适当的安全措施来保护用户数据免受各种类型的攻击。同时，保持浏览器更新，修复已知漏洞也是至关重要的。
